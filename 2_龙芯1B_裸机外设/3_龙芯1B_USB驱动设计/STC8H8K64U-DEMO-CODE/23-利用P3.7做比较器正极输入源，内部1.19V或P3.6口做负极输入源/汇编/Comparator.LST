A51 MACRO ASSEMBLER  COMPARATOR                                                           03/03/2021 16:10:37 PAGE     1


MACRO ASSEMBLER A51 V8.2.7.0
OBJECT MODULE PLACED IN Comparator.OBJ
ASSEMBLER INVOKED BY: C:\Keil_v5\C51\BIN\A51.EXE Comparator.asm SET(SMALL) DEBUG EP

LOC  OBJ            LINE     SOURCE

                       1     ;/*---------------------------------------------------------------------*/
                       2     ;/* --- STC MCU Limited ------------------------------------------------*/
                       3     ;/* --- STC 1T Series MCU Demo Programme -------------------------------*/
                       4     ;/* --- Mobile: (86)13922805190 ----------------------------------------*/
                       5     ;/* --- Fax: 86-0513-55012956,55012947,55012969 ------------------------*/
                       6     ;/* --- Tel: 86-0513-55012928,55012929,55012966 ------------------------*/
                       7     ;/* --- Web: www.STCMCU.com --------------------------------------------*/
                       8     ;/* --- Web: www.STCMCUDATA.com ----------------------------------------*/
                       9     ;/* --- QQ:  800003751 -------------------------------------------------*/
                      10     ;/* Èç¹ûÒªÔÚ³ÌÐòÖÐÊ¹ÓÃ´Ë´úÂë,ÇëÔÚ³ÌÐòÖÐ×¢Ã÷Ê¹ÓÃÁËSTCµÄ×ÊÁÏ¼°³ÌÐò        */
                      11     ;/*---------------------------------------------------------------------*/
                      12     
                      13     
                      14     ;*************  ¹¦ÄÜËµÃ÷    **************
                      15     
                      16     ;±¾Àý³Ì»ùÓÚSTC8H8K64UÎªÖ÷¿ØÐ¾Æ¬µÄÊµÑéÏä8½øÐÐ±àÐ´²âÊÔ£¬STC8G¡¢STC8HÏµÁÐÐ¾Æ¬¿ÉÍ¨ÓÃ²Î¿¼.
                      17     
                      18     ;±È½ÏÆ÷µÄÕý¼«¿ÉÒÔÊÇ P3.7 ¶Ë¿Ú»òÕß ADC µÄÄ£ÄâÊäÈëÍ¨µÀ£¬
                      19     
                      20     ;¶ø¸º¼«¿ÉÒÔÊÇ P3.6 ¶Ë¿Ú»òÕßÊÇÄÚ²¿ BandGap ¾­¹ý OP ºóµÄ REFV µçÑ¹£¨1.19VÄÚ²¿¹Ì¶¨±È½ÏµçÑ¹£©¡£
                      21     
                      22     ;Í¨¹ýÖÐ¶Ï»òÕß²éÑ¯·½Ê½¶ÁÈ¡±È½ÏÆ÷±È½Ï½á¹û£¬CMP+µÄµçÆ½µÍÓÚCMP-µÄµçÆ½P47¿ÚÊä³öµÍµçÆ½(LED10ÁÁ)£¬
                             ·´Ö®Êä³ö¸ßµçÆ½(LED10Ãð)¡£
                      23     
                      24     ;ÏÂÔØÊ±, Ñ¡ÔñÊ±ÖÓ 24MHZ (ÓÃ»§¿É×ÔÐÐÐÞ¸ÄÆµÂÊ).
                      25     
                      26     ;******************************************
                      27     
                      28     ;/****************************** ÓÃ»§¶¨Òåºê ***********************************/
                      29     
  5DC0                30     Fosc_KHZ    EQU 24000   ;24MHZ
                      31     
  00D0                32     STACK_POIRTER   EQU     0D0H    ; ¶ÑÕ»¿ªÊ¼µØÖ·
                      33     
                      34     ;*******************************************************************
                      35     ;*******************************************************************
                      36     
  00BA                37     P_SW2     DATA 0BAH
  00E6                38     CMPCR1    DATA 0E6H
  00E7                39     CMPCR2    DATA 0E7H
  00C0                40     P4        DATA 0C0H
                      41     
  0093                42     P0M1    DATA    0x93    ; P0M1.n,P0M0.n     =00--->Standard,    01--->push-pull
  0094                43     P0M0    DATA    0x94    ;                   =10--->pure input,  11--->open drain
  0091                44     P1M1    DATA    0x91    ; P1M1.n,P1M0.n     =00--->Standard,    01--->push-pull
  0092                45     P1M0    DATA    0x92    ;                   =10--->pure input,  11--->open drain
  0095                46     P2M1    DATA    0x95    ; P2M1.n,P2M0.n     =00--->Standard,    01--->push-pull
  0096                47     P2M0    DATA    0x96    ;                   =10--->pure input,  11--->open drain
  00B1                48     P3M1    DATA    0xB1    ; P3M1.n,P3M0.n     =00--->Standard,    01--->push-pull
  00B2                49     P3M0    DATA    0xB2    ;                   =10--->pure input,  11--->open drain
  00B3                50     P4M1    DATA    0xB3    ; P4M1.n,P4M0.n     =00--->Standard,    01--->push-pull
  00B4                51     P4M0    DATA    0xB4    ;                   =10--->pure input,  11--->open drain
  00C9                52     P5M1    DATA    0xC9    ; P5M1.n,P5M0.n     =00--->Standard,    01--->push-pull
  00CA                53     P5M0    DATA    0xCA    ;                   =10--->pure input,  11--->open drain
  00CB                54     P6M1    DATA    0xCB    ; P6M1.n,P6M0.n     =00--->Standard,    01--->push-pull
  00CC                55     P6M0    DATA    0xCC    ;                   =10--->pure input,  11--->open drain
  00E1                56     P7M1    DATA    0xE1    ;
  00E2                57     P7M0    DATA    0xE2    ;
A51 MACRO ASSEMBLER  COMPARATOR                                                           03/03/2021 16:10:37 PAGE     2

                      58             
                      59     ;*************  IO¿Ú¶¨Òå    **************/
                      60     
                      61     
                      62     ;*************  ±¾µØ±äÁ¿ÉùÃ÷    **************/
                      63     
                      64     
                      65     ;*******************************************************************
                      66     ;*******************************************************************
0000                  67             ORG     0000H               ;reset
0000 020100           68             LJMP    F_Main
                      69     
00AB                  70             ORG     00ABH               ;21  CMP interrupt
00AB 020145           71             LJMP    F_CMP_Interrupt
                      72     
                      73     
                      74     ;*******************************************************************
                      75     ;*******************************************************************
                      76     
                      77     
                      78     ;******************** Ö÷³ÌÐò **************************/
0100                  79             ORG     0100H       ;reset
0100                  80     F_Main:
0100 E4               81         CLR     A
0101 F593             82         MOV     P0M1, A     ;ÉèÖÃÎª×¼Ë«Ïò¿Ú
0103 F594             83         MOV     P0M0, A
0105 F591             84         MOV     P1M1, A     ;ÉèÖÃÎª×¼Ë«Ïò¿Ú
0107 F592             85         MOV     P1M0, A
0109 F595             86         MOV     P2M1, A     ;ÉèÖÃÎª×¼Ë«Ïò¿Ú
010B F596             87         MOV     P2M0, A
010D F5B1             88         MOV     P3M1, A     ;ÉèÖÃÎª×¼Ë«Ïò¿Ú
010F F5B2             89         MOV     P3M0, A
0111 F5B3             90         MOV     P4M1, A     ;ÉèÖÃÎª×¼Ë«Ïò¿Ú
0113 F5B4             91         MOV     P4M0, A
0115 F5C9             92         MOV     P5M1, A     ;ÉèÖÃÎª×¼Ë«Ïò¿Ú
0117 F5CA             93         MOV     P5M0, A
0119 F5CB             94         MOV     P6M1, A     ;ÉèÖÃÎª×¼Ë«Ïò¿Ú
011B F5CC             95         MOV     P6M0, A
011D F5E1             96         MOV     P7M1, A     ;ÉèÖÃÎª×¼Ë«Ïò¿Ú
011F F5E2             97         MOV     P7M0, A
                      98     
                      99         
0121 7581D0          100         MOV     SP, #STACK_POIRTER
0124 75D000          101         MOV     PSW, #0
                     102         USING   0       ;Ñ¡ÔñµÚ0×éR0~R7
                     103     
                     104     ;================= ÓÃ»§³õÊ¼»¯³ÌÐò ====================================
                     105     
0127 53BAF7          106         ANL     P_SW2, #NOT 08H     ; Ñ¡ÔñP3.4×÷Îª±È½ÏÆ÷Êä³ö½Å
012A E4              107         CLR     A
012B 547F            108         ANL     A, #NOT 080H        ;±È½ÏÆ÷ÕýÏòÊä³ö
                     109     ;    ORL     A, #080H            ;±È½ÏÆ÷·´ÏòÊä³ö
012D 54BF            110         ANL     A, #NOT 040H        ;Ê¹ÄÜ0.1usÂË²¨
                     111     ;    ORL     A, #040H            ;½ûÖ¹0.1usÂË²¨
                     112     ;    ANL     A, #NOT 03FH        ;±È½ÏÆ÷½á¹ûÖ±½ÓÊä³ö
012F 4410            113         ORL     A, #010H            ;±È½ÏÆ÷½á¹û¾­¹ý16¸öÈ¥¶¶Ê±ÖÓºóÊä³ö
0131 F5E7            114         MOV     CMPCR2, A
                     115     
0133 E4              116         CLR     A
0134 4430            117         ORL     A, #030H            ;Ê¹ÄÜ±È½ÏÆ÷±ßÑØÖÐ¶Ï
                     118     ;    ANL     A, #NOT 020H        ;½ûÖ¹±È½ÏÆ÷ÉÏÉýÑØÖÐ¶Ï
                     119     ;    ORL     A, #020H            ;Ê¹ÄÜ±È½ÏÆ÷ÉÏÉýÑØÖÐ¶Ï
                     120     ;    ANL     A, #NOT 010H        ;½ûÖ¹±È½ÏÆ÷ÏÂ½µÑØÖÐ¶Ï
                     121     ;    ORL     A, #010H            ;Ê¹ÄÜ±È½ÏÆ÷ÏÂ½µÑØÖÐ¶Ï
0136 54F7            122         ANL     A, #NOT 08H         ;P3.7ÎªCMP+ÊäÈë½Å
                     123     ;    ORL     A, #08H             ;ADCÊäÈë½ÅÎªCMP+ÊäÈë½Ì
A51 MACRO ASSEMBLER  COMPARATOR                                                           03/03/2021 16:10:37 PAGE     3

0138 54FB            124         ANL     A, #NOT 04H         ;ÄÚ²¿²Î¿¼µçÑ¹ÎªCMP-ÊäÈë½Å
                     125     ;    ORL     A, #04H             ;P3.6ÎªCMP-ÊäÈë½Å
                     126     ;    ANL     A, #NOT 02H         ;½ûÖ¹±È½ÏÆ÷Êä³ö
013A 4402            127         ORL     A, #02H             ;Ê¹ÄÜ±È½ÏÆ÷Êä³ö
013C 4480            128         ORL     A, #080H            ;Ê¹ÄÜ±È½ÏÆ÷Ä£¿é
013E F5E6            129         MOV     CMPCR1, A
                     130     
                     131     ;    MOV     CMPCR2, #10H        ; ±È½ÏÆ÷ÕýÏòÊä³ö,Ê¹ÄÜ0.1usÂË²¨,±È½ÏÆ÷½á¹û¾­¹ý16¸öÈ¥¶¶Ê±ÖÓº
                             óÊä³ö
                     132     ;    MOV     CMPCR1, #0B2H       ; Ê¹ÄÜ±È½ÏÆ÷Ä£¿é,Ê¹ÄÜ±È½ÏÆ÷±ßÑØÖÐ¶Ï,P3.7ÎªCMP+ÊäÈë½Å,ÄÚ²¿²
                             Î¿¼µçÑ¹ÎªCMP-ÊäÈë½Å,Ê¹ÄÜ±È½ÏÆ÷Êä³ö
0140 D2AF            133         SETB    EA          ; ´ò¿ª×ÜÖÐ¶Ï
                     134         
                     135     ;=================== Ö÷Ñ­»· ==================================
0142                 136     L_MainLoop:
                     137     
                     138         ;MOV     A, CMPCR1
                     139             ;RRC     A
                     140             ;MOV     P4.7,C
                     141     
0142 020142          142         LJMP    L_MainLoop
                     143     
                     144     ;**********************************************/
                     145     
                     146     
                     147     ;========================================================================
                     148     ; º¯Êý: F_CMP_Interrupt
                     149     ; ÃèÊö: ±È½ÏÆ÷ÖÐ¶Ïº¯Êý.
                     150     ; ²ÎÊý: non.
                     151     ; ·µ»Ø: non.
                     152     ; °æ±¾: V1.0, 2021-3-3
                     153     ;========================================================================
0145                 154     F_CMP_Interrupt:
0145 C0D0            155         PUSH    PSW
0147 C0E0            156         PUSH    ACC
0149 C002            157         PUSH    AR2
                     158     
014B 53E6BF          159         ANL     CMPCR1, #NOT 040H      ; ÇåÖÐ¶Ï±êÖ¾
014E E5E6            160         MOV     A, CMPCR1
0150 13              161             RRC     A
0151 92C7            162             MOV     P4.7,C
                     163     
0153                 164     L_QuitCMP_Init:
0153 D002            165         POP     AR2
0155 D0E0            166         POP     ACC
0157 D0D0            167         POP     PSW
0159 32              168         RETI
                     169     
                     170     ;*******************************************************************
                     171     
                     172         END
                             
A51 MACRO ASSEMBLER  COMPARATOR                                                           03/03/2021 16:10:37 PAGE     4

SYMBOL TABLE LISTING
------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES

ACC. . . . . . . .  D ADDR   00E0H   A   
AR2. . . . . . . .  D ADDR   0002H   A   
CMPCR1 . . . . . .  D ADDR   00E6H   A   
CMPCR2 . . . . . .  D ADDR   00E7H   A   
EA . . . . . . . .  B ADDR   00A8H.7 A   
FOSC_KHZ . . . . .  N NUMB   5DC0H   A   
F_CMP_INTERRUPT. .  C ADDR   0145H   A   
F_MAIN . . . . . .  C ADDR   0100H   A   
L_MAINLOOP . . . .  C ADDR   0142H   A   
L_QUITCMP_INIT . .  C ADDR   0153H   A   
P0M0 . . . . . . .  D ADDR   0094H   A   
P0M1 . . . . . . .  D ADDR   0093H   A   
P1M0 . . . . . . .  D ADDR   0092H   A   
P1M1 . . . . . . .  D ADDR   0091H   A   
P2M0 . . . . . . .  D ADDR   0096H   A   
P2M1 . . . . . . .  D ADDR   0095H   A   
P3M0 . . . . . . .  D ADDR   00B2H   A   
P3M1 . . . . . . .  D ADDR   00B1H   A   
P4 . . . . . . . .  D ADDR   00C0H   A   
P4M0 . . . . . . .  D ADDR   00B4H   A   
P4M1 . . . . . . .  D ADDR   00B3H   A   
P5M0 . . . . . . .  D ADDR   00CAH   A   
P5M1 . . . . . . .  D ADDR   00C9H   A   
P6M0 . . . . . . .  D ADDR   00CCH   A   
P6M1 . . . . . . .  D ADDR   00CBH   A   
P7M0 . . . . . . .  D ADDR   00E2H   A   
P7M1 . . . . . . .  D ADDR   00E1H   A   
PSW. . . . . . . .  D ADDR   00D0H   A   
P_SW2. . . . . . .  D ADDR   00BAH   A   
SP . . . . . . . .  D ADDR   0081H   A   
STACK_POIRTER. . .  N NUMB   00D0H   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
